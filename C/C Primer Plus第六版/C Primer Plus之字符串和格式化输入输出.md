# C primer Plus之字符串和格式化输入输出

## 1. 前导程序

```c
#include <stdio.h>
// 引入String字符串的头文件
// 提供strlen()函数的原型
#include <string.h>
// #define指令 也叫做预处理器指令
// 当前预处理指令提前定义常量DENSITY定义为62.4, 方便代码中直接引入
#define DENSITY 62.4

int main(void) {

    char name[40];
    int age, size, letters;
    printf("%f", DENSITY);


    // 处理姓名
    printf("你叫什么名字? \n");
    scanf("%s", name);
    // 处理年龄
    printf("你有多少岁? \n");
    scanf("%d", &age);

    // 获取数组的大小
    size = sizeof(name);
    // 获取数组中存储字符的实际长度, 也就是字符串的长度
    letters = strlen(name);

    printf("你的姓名由%d个字符组成, %s \n", letters, name);
    printf("当前有多少%d个字节存储它", size);

    return 0;
}
```

- 输出结果

```
62.400000 
你叫什么名字? 
Tony
你有多少岁? 
18
你的姓名由4个字符组成, Tony 
当前有多少40个字节存储它
```

### 1.1 程序解读

- 引入String字符串头文件，提供操作字符串的相关函数

```c
#include <string.h>
```

- 预处理指令

```c
#define DENSITY 62.4
```

通过 `#define`关键字定义预处理指定，预处理指令表示在程序之前的准备工作。

`#define DENSITY 62.4`表示在程序运行之前，提前定义好 `DENSITY`常量，并将其赋值。值得注意的是，通过预处理指令定义的常量是不能修改的，只能在程序中引用。`printf("%f", DENSITY);`就是程序中对预处理指令中定义的常量的引用。

- 数组的声明

```c
char name[40];
```

声明一个可以存储40个字符的字符型数组，当前使用字符数组存储字符串。

数组由连续的存储单元组成，字符串中的字符被存储在相邻的存储单元中，每个单元存储一个字符。

- 字符串使用scanf函数赋值，与字符串的格式化输出

```c
scanf("%s", name);
printf("你的姓名由%d个字符组成, %s \n", letters, name);
```

字符串使用 `%s` 来赋值和打印。值得注意的是，使用scanf为字符串赋值时，与对基本数据类型的变量赋值不同的是没有借助 `&`符号，比如 `scanf("%d", &age);`语句中，对age进行赋值时，就用到了 `&`。

> 注意：
>
> scanf函数读取字符串时，他在遇到第1个空白（空格、制表符或者换行符）时就不再读取输入。

- 获取数组的大小

```c
 size = sizeof(name);
```

借助内置运算符sizeof，可以获取到数组占用的字节大小，因为char型字符只会占用一个字节，所以40个char型字符就会占用40个字节。

- 获取字符串的长度

```c
 letters = strlen(name);
```

借助strlen函数获取到字符串的长度。

## 2. 数组

> 数组是同类型数据元素的有序序列。

### 2.1 数组的特点

- 内存中的连续性。数组由连续的存储单员组成。
- 存储的是同类型元素。

> 注意：
>
> 如果数组的大小大于实际存储的数据的大小， 多余的部分一般而言会存储垃圾垃圾数据。（经测试，整型数组多余的部分存储的是0；而字符型数组存储的随机垃圾字符，每次输出的值都不一样）。

代码示例

```c
#include <stdio.h>

/**
 * 数组
 * @return
 */
int main(void) {

    // 声明一个整数类型的数组
    // 只能存储的整数类型的数
    // 在内存中是连续的创建了10个整数存取空间
    // 当前操作系统,一个int类型占用4个字节,5个占用20个字节
    // 所以数组a直接在内存中创建了20个字节内存大小
    int a[] = {1,2,3,4,5};

    printf("%zd", sizeof a);

    return 0;
};
```

输出结果

```
20
```

## 3. 字符串

### 3.1 字符串的特点

- 字符串是一个或多个字符的序列。
- 字符串用双引号包裹。
- C语言中没有专门用于存储字符串的变量类型，字符串都被存储在char类型的数组中。
- C语言中的字符串一定以`空字符`结束，这意味着数组的容量必须至少比待存储字符串中的字符数多1。

> 注：空字符用转义字符表示就是 `\0`。空字符是非打印字符，因为在char型数据中\0会被解析成八进制的标志。空字符在ASCII码值是0。

### 3.2 比较'A'和"A"

- 'A'是字符常量，而"A"是字符串常量。
- 'A'是char基本类型，而"A"是char数组派生类型。
- "A"实际上由两个字符组成（'A'和'\0'）。

## 4. 常量和C预处理器

什么是常量？常量就是在初始化之后`不能被修改`的数据。

### 4.1 定义常量的几种方式

- 数据未被赋值给提前定义好的数据类型而直接参与运算的数据。
- 通过C预处理器定义的常量
- 通过关键字const声明的常量

几种方式的代码演示

```c
// 通过预处理器定义常量
#define PI 3.141592654

/**
 * 定义常量
 * @return
 */
int main(void) {

    int a = 1;
    // 这里的2就是未被声明直接使用,2就是常量,不会被重复利用
    int b = a + 2;
    // 这里调用预处理器定义的常量
    double c = a * b * PI;
    // 这里使用const关键字定义常量
    const int D = 5;

    return 0;
};
```

> 注：
>
> 1、一般通过预处理器和const声明的常量因为具有常量名所以也叫符号常量。
>
> 2、符号常量相对于通过直接使用声明的常量的优势：
>
> - 具有常量名的话可以重复使用。
> - 当需要修改常量的值时，我们直接修改一处即可，其他引用常量名的地方自动会修改。
> - 常量名看起来比数字表达的信息更多，通过常量名可以帮助我们传达出该常量的实际意义。
>
> 3、符号常量一般情况下，常量名采用大写声明，方便区分常量和变量。有时也会用c\_或者k\_前缀来表达。

### 4.2 预处理器

预处理器的作用在于为程序声明各种数据类型的常量。

- 预处理器声明常量的格式

```c
#defined 常量名 常量值
```

- 预处理器工作原理

在程序中通过使用预处理器的常量名称使用到常量值，C语言在编译期间会将程序中所有的常量名替换成指定的常量值，这一过程也叫 `编译时替换`。

### 4.3 const限定符

通过const限定符声明的变量会被限定为只读，那么换句话说，通过const声明的数据就是常量。

- const限定符声明常量的的格式

```c
const 数据类型 常量名 = 常量值;
```

